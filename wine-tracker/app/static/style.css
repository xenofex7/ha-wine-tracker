/* ══════════════════════════════════════════════════════════════════════════════
   Wine Tracker – Unified Stylesheet
   Shared between index.html and stats.html
   ══════════════════════════════════════════════════════════════════════════════ */

/* ── Theme Variables ───────────────────────────────────────────────────────── */
:root {
  --bg: #1a0a0f;
  --surface: #2a1520;
  --surface2: #3a1f2c;
  --border: #5a2a3a;
  --accent: #c0392b;
  --accent2: #8b1a2a;
  --gold: #d4a843;
  --text: #f0e0e5;
  --muted: #9a7a82;
  --empty: #3a2a30;
  --radius: 12px;
  --shadow: 0 4px 24px rgba(0,0,0,.5);
  /* Wine type colors */
  --wine-rotwein: #803039;
  --wine-weisswein: #f4ca4f;
  --wine-rose: #ffd1d8;
  --wine-schaumwein: #f3efaf;
  --wine-dessertwein: #eb7a17;
  --wine-likoerwein: #800f1c;
  --wine-anderes: #6c3461;
  --wine-empty: #aaa;
}
html.light {
  --bg: #f5f0eb;
  --surface: #ffffff;
  --surface2: #f0e8e0;
  --border: #ddd0c8;
  --accent: #a03025;
  --accent2: #7a1520;
  --gold: #9a7a20;
  --text: #2a1a10;
  --muted: #7a6a60;
  --empty: #ece5de;
  --shadow: 0 4px 24px rgba(0,0,0,.1);
}

/* ── Base Reset ────────────────────────────────────────────────────────────── */
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
       background: var(--bg); color: var(--text); min-height: 100vh; }
.mdi { vertical-align: middle; }

/* ── Header (shared) ──────────────────────────────────────────────────────── */
header {
  background: var(--surface);
  height: 55px; padding: 0 1.5rem;
  display: flex; align-items: center; gap: .75rem;
  border-bottom: 1px solid var(--border);
  position: sticky; top: 0; z-index: 100;
  box-shadow: var(--shadow);
}
.nav-brand {
  display: flex; align-items: center; gap: .4rem;
  font-size: 1.15rem; font-weight: 700; color: var(--text);
  text-decoration: none; flex-shrink: 0;
}
.nav-brand .mdi { font-size: 2rem; color: var(--accent); }
.nav-links {
  display: flex; gap: .25rem; flex-shrink: 0;
}
.nav-link {
  padding: .35rem .75rem; border-radius: 8px; font-size: .85rem;
  color: var(--muted); text-decoration: none; transition: all .2s;
  font-weight: 500;
}
.nav-link:hover { color: var(--text); background: rgba(0,0,0,.08); }
.nav-link.active { color: var(--text); font-weight: 700; }
html.light .nav-link:hover { background: rgba(0,0,0,.06); }
.header-spacer { flex: 1; }
.theme-toggle {
  background: none; border: 1px solid var(--border); color: var(--muted);
  height: 34px; width: 34px; border-radius: 8px; cursor: pointer;
  font-size: 1.1rem; display: flex; align-items: center; justify-content: center;
  transition: all .2s; flex-shrink: 0;
}
.theme-toggle:hover { color: var(--text); border-color: var(--text); }

/* ── Search ───────────────────────────────────────────────────────────────── */
.search-wrap {
  position: relative; width: 200px; flex-shrink: 0;
  display: flex; align-items: center;
  background: var(--bg); border: 1px solid var(--border);
  border-radius: 8px; height: 34px; box-sizing: border-box;
}
.search-icon {
  padding-left: .65rem; color: var(--muted); font-size: .9rem;
  pointer-events: none; flex-shrink: 0; display: flex; align-items: center;
}
.search-wrap input {
  width: 100%; background: transparent; border: none;
  padding: 0 2rem 0 .45rem;
  color: var(--text); font-size: .85rem; height: 100%; outline: none;
}
.search-wrap:focus-within { border-color: var(--accent); }
.search-clear {
  position: absolute; right: .5rem; top: 50%; transform: translateY(-50%);
  background: none; border: none; color: var(--muted); font-size: 1.1rem;
  cursor: pointer; line-height: 1; padding: .2rem; display: none;
}
.search-clear:hover { color: var(--text); }
.search-wrap input:not(:placeholder-shown) + .search-clear { display: block; }

/* ── Filter Dropdown ──────────────────────────────────────────────────────── */
.filter-dropdown-wrap { position: relative; flex-shrink: 0; }
.filter-btn {
  background: none; border: 1px solid var(--border); color: var(--muted);
  height: 34px; width: 34px; border-radius: 8px; cursor: pointer;
  font-size: 1.1rem; display: flex; align-items: center; justify-content: center;
  transition: all .2s;
}
.filter-btn:hover { color: var(--text); border-color: var(--text); }
.filter-dropdown {
  display: none; position: absolute; top: calc(100% + 6px); right: 0;
  background: var(--bg); border: 1px solid var(--border);
  border-radius: 10px; padding: .6rem; box-shadow: var(--shadow);
  z-index: 200; min-width: 180px;
}
.filter-dropdown.open { display: block; }
.filter-divider {
  border: none; border-top: 1px solid var(--border); margin: .5rem 0;
}

.filter-list { display: flex; flex-direction: column; gap: .15rem; }
.filter-option {
  display: flex; align-items: center; gap: .5rem;
  padding: .4rem .6rem; border-radius: 6px; font-size: .82rem;
  color: var(--muted); cursor: pointer; transition: all .15s;
  white-space: nowrap;
}
.filter-option:hover { color: var(--text); background: rgba(0,0,0,.06); }
.filter-option.active { color: var(--text); font-weight: 600; }
html.light .filter-option:hover { background: rgba(0,0,0,.05); }
.filter-option input[type="radio"] { accent-color: var(--accent); margin: 0; }

.toggle-empty-option {
  font-size: .82rem; color: var(--muted); cursor: pointer;
  white-space: nowrap;
}
.toggle-empty-option:hover { color: var(--text); }

/* ── Header: Mobile ───────────────────────────────────────────────────────── */
@media (max-width: 600px) {
  header { padding: 0 .75rem; gap: .5rem; }
  .nav-brand span, .nav-brand-text { display: none; }
  .nav-link { font-size: .78rem; padding: .3rem .5rem; }
  .search-wrap { width: 120px; height: 30px; }
  .search-wrap input { font-size: .8rem; }
  .filter-btn { height: 30px; width: 30px; }
  .theme-toggle { height: 30px; width: 30px; }
}

/* ── Index: Grid & Cards ───────────────────────────────────────────────────── */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 1rem; padding: 1.25rem 1.5rem;
  padding-bottom: 5rem;
}

.card {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden;
  transition: transform .2s, box-shadow .2s; cursor: pointer;
  position: relative;
  display: flex; flex-direction: column;
}
.card:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

/* ── Corner Ribbon ──────────────────────────────────────── */
.ribbon {
  position: absolute; top: 18px; left: -35px;
  width: 130px; text-align: center;
  padding: 4px 0; font-size: .65rem; font-weight: 700;
  text-transform: uppercase; letter-spacing: .5px;
  color: #fff; z-index: 2;
  transform: rotate(-45deg);
  box-shadow: 0 2px 4px rgba(0,0,0,.18);
}
.ribbon-rotwein     { background: var(--wine-rotwein); }
.ribbon-weisswein   { background: var(--wine-weisswein); color: #333; }
.ribbon-rose        { background: var(--wine-rose); color: #333; }
.ribbon-schaumwein  { background: var(--wine-schaumwein); color: #333; }
.ribbon-dessertwein { background: var(--wine-dessertwein); }
.ribbon-likoerwein  { background: var(--wine-likoerwein); }
.ribbon-anderes     { background: var(--wine-anderes); }
.ribbon-empty       { background: var(--wine-empty); }

.card.empty { opacity: .5; background: var(--empty); border-style: dashed; }
.card.empty:hover { opacity: .75; }
.card.highlight { animation: glow 2s ease-out forwards; }
@keyframes glow {
  0%   { box-shadow: 0 0 20px 6px rgba(212,168,67,.7); }
  70%  { box-shadow: 0 0 15px 4px rgba(212,168,67,.4); }
  100% { box-shadow: none; }
}

.card-img {
  width: 100%; height: 160px; object-fit: cover;
  background: var(--surface2);
  display: flex; align-items: center; justify-content: center;
  font-size: 3.5rem; color: var(--muted);
}
.card-img img { width: 100%; height: 100%; object-fit: cover; cursor: zoom-in; }
.card-img .mdi { font-size: 3rem; }

.qty-badge {
  position: absolute; top: .6rem; right: .6rem;
  background: rgba(0,0,0,.75); backdrop-filter: blur(4px);
  border: 1px solid var(--border); border-radius: 20px;
  padding: .2rem .6rem; font-size: .8rem; font-weight: 700;
  color: var(--muted);
}
.qty-badge.has { color: var(--gold); }

.card-body { padding: .75rem 1rem; }
.card-name { font-weight: 700; font-size: 1rem; margin-bottom: .2rem;
             white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-meta { font-size: .8rem; color: var(--muted); display: flex; gap: .5rem; flex-wrap: wrap; }
.card-meta span { background: var(--bg); padding: .1rem .4rem; border-radius: 4px; }

.stars { color: var(--gold); font-size: .85rem; margin-top: .35rem; letter-spacing: 1px; }
.stars .mdi { font-size: .95rem; vertical-align: middle; }
.card-notes { font-size: .78rem; color: var(--muted); margin-top: .4rem;
              white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-extra { display: flex; flex-wrap: wrap; gap: .35rem; margin-top: .4rem; }
.card-extra span { font-size: .75rem; padding: .15rem .45rem; border-radius: 4px;
                   background: var(--bg); color: var(--muted); }
.card-extra .price { color: var(--gold); }
.card-extra .drink-window { color: #7ab8a0; }

.card-actions {
  display: flex; border-top: 1px solid var(--border);
  margin-top: auto;
}
.card-actions button {
  flex: 1; background: none; border: none; color: var(--muted);
  padding: .5rem; cursor: pointer; font-size: .8rem; transition: all .2s;
}
.card-actions button:hover { background: var(--surface2); color: var(--text); }
.card-actions button.danger:hover { background: #5a1010; color: #e74c3c; }
.card-actions button + button { border-left: 1px solid var(--border); }
.card-actions .mdi { font-size: 1.05rem; }

/* Qty controls */
.qty-controls { display: flex; align-items: center; gap: .5rem; }
.qty-btn {
  background: var(--surface2); border: 1px solid var(--border);
  color: var(--text); width: 26px; height: 26px; border-radius: 6px;
  cursor: pointer; font-size: 1rem; line-height: 1;
  display: flex; align-items: center; justify-content: center;
}
.qty-btn:hover { background: var(--accent); border-color: var(--accent); }

/* Vivino link on cards */
.card-vivino-link {
  display: inline-flex; align-items: center; gap: .25rem;
  font-size: .75rem; color: var(--muted); text-decoration: none;
  transition: color .15s;
}
.card-vivino-link:hover { color: #a41548; }
.card-vivino-link img { width: 14px; height: 14px; opacity: .6; }

/* ── Index: Empty State ────────────────────────────────────────────────────── */
.empty-state {
  text-align: center; padding: 4rem 2rem; color: var(--muted);
}
.empty-state div { font-size: 4rem; margin-bottom: 1rem; }
.empty-state .mdi { font-size: 4rem; }

/* ── Index: FAB Button ─────────────────────────────────────────────────────── */
.fab {
  display: flex;
  align-items: center;
  justify-content: center;
  position: fixed;
  bottom: 1.5rem;
  right: 1.5rem;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: var(--accent);
  color: white;
  border: none;
  font-size: 1.6rem;
  cursor: pointer;
  box-shadow: 0 4px 16px rgba(0,0,0,.4);
  z-index: 150;
  transition: transform .2s, box-shadow .2s;
}
.fab:hover { background: #e74c3c; transform: scale(1.05); box-shadow: 0 6px 20px rgba(0,0,0,.5); }
.fab:active { transform: scale(0.92); box-shadow: 0 2px 8px rgba(0,0,0,.3); }

/* ── Overlay Base (shared lightbox + modal) ────────────────────────────────── */
.lightbox-overlay,
.modal-overlay {
  display: none; position: fixed; inset: 0;
  align-items: center; justify-content: center; padding: 1rem;
}
.lightbox-overlay.open,
.modal-overlay.open { display: flex; }

/* ── Index: Lightbox ───────────────────────────────────────────────────────── */
.lightbox-overlay {
  background: rgba(0,0,0,.92); z-index: 300; cursor: zoom-out;
}
.lightbox-overlay img {
  max-width: 95%; max-height: 92vh; object-fit: contain;
  border-radius: 8px; box-shadow: 0 0 40px rgba(0,0,0,.6);
}
.lightbox-close,
.modal-close {
  background: none; border: none; cursor: pointer; line-height: 1;
}
.lightbox-close {
  position: absolute; top: 1rem; right: 1.2rem;
  color: rgba(255,255,255,.7); font-size: 2rem; z-index: 301;
}
.lightbox-close:hover { color: #fff; }

/* ── Modal (shared) ────────────────────────────────────────────────────────── */
.modal-overlay {
  background: rgba(0,0,0,.75); z-index: 200;
}
.modal {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); width: 100%; max-width: 360px;
  max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow);
}
.modal-header {
  padding: 1rem 1.25rem; font-weight: 700; font-size: 1.1rem;
  border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
  position: sticky; top: 0; background: var(--surface); z-index: 1;
}
.modal-close { color: var(--muted); font-size: 1.3rem; }
.modal-close:hover { color: var(--text); }
.modal-body { padding: 1.25rem; display: flex; flex-direction: column; gap: .9rem; }
.form-fields-panel { display: flex; flex-direction: column; gap: .9rem; }

/* Delete confirm modal */
.delete-confirm-body { text-align: center; padding: 1.5rem 1.25rem; }
.delete-confirm-icon { font-size: 3rem; margin-bottom: .75rem; }
.delete-confirm-msg { font-size: .95rem; color: var(--text); margin-bottom: .25rem; }
.delete-confirm-name { font-weight: 700; color: var(--gold); }
.delete-confirm-sub { font-size: .8rem; color: var(--muted); margin-top: .35rem; }
.delete-confirm-actions {
  display: flex; gap: .75rem; padding: 0 1.25rem 1.25rem;
}
.btn-cancel {
  flex: 1; background: var(--bg); color: var(--text); border: 1px solid var(--border);
  padding: .6rem 1rem; border-radius: 8px; font-size: .9rem;
  cursor: pointer; font-weight: 600; transition: all .2s;
}
.btn-cancel:hover { background: var(--surface2); border-color: var(--text); }
.btn-delete {
  flex: 1; background: #c0392b; color: white; border: none;
  padding: .6rem 1rem; border-radius: 8px; font-size: .9rem;
  cursor: pointer; font-weight: 600; transition: background .2s;
}
.btn-delete:hover { background: #e74c3c; }

/* Duplicate modal */
.dup-hint { font-size: .82rem; color: var(--muted); background: var(--bg);
            border-radius: 8px; padding: .75rem; line-height: 1.5; }

/* ── Form Elements ─────────────────────────────────────────────────────────── */
label { font-size: .8rem; color: var(--muted); display: block; margin-bottom: .25rem; }
input[type=text], input[type=number], select, textarea {
  width: 100%; background: var(--bg); border: 1px solid var(--border);
  border-radius: 8px; padding: .55rem .75rem; color: var(--text); font-size: .9rem;
  transition: border-color .2s; height: 38px; box-sizing: border-box;
}
.search-wrap input[type=text] {
  border: none; background: transparent; border-radius: 0; height: 100%;
  padding: 0 2rem 0 .45rem;
}
textarea { height: auto; }
select {
  -webkit-appearance: none; -moz-appearance: none; appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23888' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: right .75rem center;
  padding-right: 2rem;
}
input:focus, select:focus, textarea:focus {
  outline: none; border-color: var(--accent);
}
select option { background: var(--bg); }
textarea { resize: vertical; min-height: 70px; font-family: inherit; }
.row2 { display: grid; grid-template-columns: 1fr 1fr; gap: .75rem; }

/* Star rating input */
.star-input { display: flex; gap: .25rem; flex-direction: row-reverse;
              justify-content: flex-end; }
.star-input input { display: none; }
.star-input label {
  font-size: 1.5rem; cursor: pointer; color: var(--border);
  margin: 0; padding: 0; transition: color .15s;
}
.star-input input:checked ~ label,
.star-input label:hover,
.star-input label:hover ~ label { color: var(--gold); }

/* Image preview */
.img-preview {
  width: 100%; height: 140px; background: var(--bg);
  border: 1px solid var(--border); border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 2rem; cursor: pointer; overflow: hidden; position: relative;
}
.img-preview img { width: 100%; height: 100%; object-fit: cover; }
.img-preview input[type=file] {
  position: absolute; inset: 0; opacity: 0; cursor: pointer; padding: 0;
}

/* Submit button */
.btn-submit {
  background: var(--accent); color: white; border: none;
  padding: .65rem 1.5rem; border-radius: 8px; font-size: .95rem;
  font-weight: 700; cursor: pointer; width: 100%; margin-top: .25rem;
  transition: background .2s;
}
.btn-submit:hover { background: #e74c3c; }

/* ── Form Footer (Submit + Reload Popover) ─────────────────────────────────── */
.form-footer {
  display: flex; align-items: center; gap: .75rem;
  margin-top: .5rem; position: relative;
}
.form-footer .btn-submit { width: auto; flex: 1; margin-top: 0; }

.reload-popover-wrap { position: relative; }
.btn-reload-trigger {
  background: var(--surface2); color: var(--text); border: 1px solid var(--border);
  padding: .55rem 1rem; border-radius: 8px; font-size: .85rem;
  font-weight: 600; cursor: pointer; white-space: nowrap;
  display: flex; align-items: center; gap: .4rem;
  transition: background .2s, border-color .2s;
}
.btn-reload-trigger:hover { border-color: var(--accent); background: var(--surface); }
.btn-reload-trigger.loading { opacity: .7; cursor: wait; }
.btn-reload-trigger .mdi-spin {
  animation: mdi-spin 1s linear infinite;
}
@keyframes mdi-spin { to { transform: rotate(360deg); } }

.reload-popover {
  position: absolute; bottom: calc(100% + .5rem); left: 0;
  background: var(--surface); border: 1px solid var(--border);
  border-radius: 10px; padding: .4rem; min-width: 220px;
  box-shadow: 0 8px 24px rgba(0,0,0,.4);
  z-index: 100;
}
.reload-popover-option {
  display: flex; align-items: center; gap: .5rem;
  width: 100%; padding: .6rem .75rem; border: none; background: none;
  color: var(--text); font-size: .88rem; cursor: pointer;
  border-radius: 6px; transition: background .15s; text-align: left;
}
.reload-popover-option:hover { background: rgba(192,57,43,.1); }
.reload-popover-option .mdi { font-size: 1.15rem; opacity: .8; }

/* ── Source Step (AI + Vivino + Manual) ─────────────────────────────────────── */
.source-step { padding: 1.5rem; max-width: 360px; margin: 0 auto; }
.source-step-header { text-align: center; margin-bottom: 1.25rem; }
.source-step-header h3 { font-size: 1.1rem; margin-bottom: .25rem; }
.source-step-header p { font-size: .85rem; color: var(--muted); }
.source-options { display: flex; flex-direction: column; gap: .75rem; }
.source-option {
  display: flex; align-items: center; gap: 1rem;
  border: 1.5px solid var(--border); border-radius: 12px;
  padding: 1rem 1.25rem; cursor: pointer; transition: all .2s;
  background: var(--surface);
}
.source-option:hover { border-color: var(--accent); background: rgba(192,57,43,.04); }
.source-option .mdi { font-size: 1.6rem; color: var(--muted); flex-shrink: 0; }
.source-option .source-text { text-align: left; }
.source-option .source-label { font-size: .95rem; font-weight: 600; margin-bottom: .15rem; }
.source-option .source-desc { font-size: .8rem; color: var(--muted); }

/* ── AI Step ───────────────────────────────────────────────────────────────── */
.ai-step { text-align: center; padding: 2rem 1.5rem; }
.ai-step h3 { font-size: 1.1rem; margin-bottom: .35rem; }
.ai-step p { font-size: .85rem; color: var(--muted); margin-bottom: 1.5rem; line-height: 1.5; }
.ai-upload-area {
  border: 2px dashed var(--border); border-radius: 12px;
  padding: 3rem 1.5rem; cursor: pointer; transition: border-color .2s, background .2s;
  position: relative; overflow: hidden;
}
.ai-upload-area:hover { border-color: var(--accent); background: rgba(192,57,43,.05); }
.ai-upload-area input[type=file] {
  position: absolute; inset: 0; opacity: 0; cursor: pointer;
}
.ai-upload-area .mdi { font-size: 2.5rem; color: var(--muted); display: block; margin-bottom: .5rem; }
.ai-upload-area span { font-size: .9rem; color: var(--muted); }
.ai-preview-wrap { margin: 1.25rem auto; position: relative; display: inline-block; }
.ai-preview-wrap img {
  max-height: 220px; max-width: 100%; border-radius: 8px;
  border: 1px solid var(--border);
}
.ai-loading { display: flex; flex-direction: column; align-items: center; gap: 1rem; padding: 1rem 0; }
.ai-spinner {
  width: 40px; height: 40px;
  border: 3px solid var(--border); border-top-color: var(--accent);
  border-radius: 50%; animation: spin .8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
.ai-loading span { font-size: .9rem; color: var(--muted); }
.ai-error-msg { color: #e74c3c; font-size: .9rem; margin: 1rem 0; }
.ai-btn-row { display: flex; gap: .75rem; justify-content: center; margin-top: 1rem; }
.ai-btn {
  padding: .5rem 1.2rem; border-radius: 8px; font-size: .85rem;
  cursor: pointer; border: 1px solid var(--border); background: var(--bg);
  color: var(--text); transition: all .2s;
}
.ai-btn:hover { border-color: var(--accent); }
.ai-btn.primary { background: var(--accent); color: white; border-color: var(--accent); }
.ai-btn.primary:hover { background: #e74c3c; }
.step-link {
  color: var(--muted); cursor: pointer;
  font-size: .85rem; display: inline-flex; align-items: center; gap: .3rem;
  text-decoration: underline; text-underline-offset: 2px;
}
.step-link:hover { color: var(--text); }
.ai-step .step-link:last-child { margin-top: 1.5rem; }

/* ── Vivino Search Panel ───────────────────────────────────────────────────── */
.vivino-panel { padding: 1.5rem; }
.vivino-panel h3 { text-align: center; font-size: 1.05rem; margin-bottom: 1rem; }
.vivino-search-input {
  width: 100%; padding: .65rem .85rem; border-radius: 8px;
  border: 1px solid var(--border); background: var(--bg); color: var(--text);
  font-size: .95rem; box-sizing: border-box;
}
.vivino-search-input:focus { border-color: var(--accent); outline: none; }
.vivino-results { margin-top: 1rem; max-height: 340px; overflow-y: auto; }
.vivino-result-item {
  display: flex; gap: .75rem; padding: .65rem .5rem;
  border-bottom: 1px solid var(--border); cursor: pointer; transition: background .15s;
  border-radius: 6px; align-items: center;
}
.vivino-result-item:hover { background: rgba(192,57,43,.06); }
.vivino-result-img {
  width: 40px; height: 56px; object-fit: contain; border-radius: 4px;
  flex-shrink: 0; background: rgba(255,255,255,.05);
}
.vivino-result-info { flex: 1; min-width: 0; }
.vivino-result-name { font-size: .9rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.vivino-result-meta { font-size: .78rem; color: var(--muted); margin-top: .15rem; }
.vivino-result-meta span + span::before { content: ' · '; }
.vivino-result-rating { color: var(--gold); font-size: .78rem; }
.vivino-status { text-align: center; padding: 1.5rem 0; color: var(--muted); font-size: .9rem; }
.vivino-status .ai-spinner { margin: 0 auto .75rem; }
.vivino-panel .step-link { margin-bottom: 1rem; }
.ai-step .step-link:first-child { margin-bottom: 0; }

/* ── Reload Toast ──────────────────────────────────────────────────────────── */
.reload-toast {
  position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%);
  padding: .75rem 1.5rem; border-radius: .5rem; font-size: .9rem;
  z-index: 9999; pointer-events: none;
  transition: opacity .4s ease;
  box-shadow: 0 4px 16px rgba(0,0,0,.3);
}
.reload-toast.success { background: var(--gold, #c8a951); color: #1a1a1a; }
.reload-toast.neutral { background: var(--surface2, #2a2a2a); color: var(--muted, #999); border: 1px solid var(--border, #444); }

/* ── Wine Modal: narrow by default, wide only when form is shown ───────────── */
#wineModal .modal { max-width: 380px; transition: max-width .25s ease; }
#wineModal.form-active .modal { max-width: 480px; }
@media (min-width: 700px) {
  #wineModal.form-active .modal { max-width: 900px; }
  #wineModal.form-active .modal-body {
    display: grid; grid-template-columns: 1fr 340px;
    gap: 1.25rem; align-items: start;
  }
  .form-photo-panel {
    order: 2; align-self: stretch;
    display: flex; flex-direction: column;
  }
  .form-photo-panel label { flex-shrink: 0; }
  .form-photo-panel .img-preview {
    flex: 1; height: auto; min-height: 180px;
  }
  .form-photo-panel .img-preview img {
    width: 100%; height: 100%; object-fit: contain; object-position: center;
  }
  .form-fields-panel { order: 1; }
}

/* ── Stats: Content ────────────────────────────────────────────────────────── */
.content { max-width: 900px; margin: 0 auto; padding: 1.5rem; }

/* ── Stats: Highlight Cards ────────────────────────────────────────────────── */
.highlights {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 1rem; margin-bottom: 1.5rem;
}
.highlight-card {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 1.2rem 1rem;
  text-align: center;
}
.highlight-card .emoji { font-size: 1.8rem; margin-bottom: .4rem; }
.highlight-card .emoji .mdi { font-size: 1.8rem; }
.highlight-card .big-number {
  font-size: 2rem; font-weight: 800; color: var(--gold);
  line-height: 1.1;
}
.highlight-card .label {
  font-size: .8rem; color: var(--muted); margin-top: .25rem;
}

/* ── Stats: Stat Cards ─────────────────────────────────────────────────────── */
.stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.25rem; margin-bottom: 1.5rem;
}
.stat-card {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden;
}
.stat-card h2,
.map-card h2 {
  padding: .85rem 1rem; font-size: .9rem; font-weight: 700;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; gap: .5rem;
  color: var(--text);
}
.stat-card h2 .mdi,
.map-card h2 .mdi { font-size: 1.1rem; }
.stat-card .stat-body { padding: 1rem; }

/* ── Stats: Donut Chart ────────────────────────────────────────────────────── */
.donut-card .stat-body { padding: 1.2rem 1.5rem; }
.donut-wrap {
  display: flex; align-items: center;
  gap: 2rem;
}
.donut-svg-wrap {
  position: relative; width: 150px; height: 150px; flex-shrink: 0;
}
.donut-svg-wrap svg { width: 100%; height: 100%; transform: rotate(-90deg); }
.donut-center {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  pointer-events: none;
}
.donut-center .big { font-size: 2rem; font-weight: 800; color: var(--text); line-height: 1; }
.donut-center .sub {
  font-size: .6rem; color: var(--muted); margin-top: .2rem;
  text-transform: uppercase; letter-spacing: .1em; font-weight: 600;
}
.donut-legend { display: flex; flex-direction: column; gap: .7rem; flex: 1; min-width: 0; }
.donut-legend-item {
  display: flex; align-items: center; gap: .6rem;
  font-size: .9rem;
}
.donut-dot {
  width: 12px; height: 12px; border-radius: 50%; flex-shrink: 0;
}
.donut-legend-label {
  flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.donut-legend-value {
  font-weight: 700; color: var(--text); font-size: .95rem; flex-shrink: 0;
  min-width: 40px; text-align: right;
}
@media (max-width: 420px) {
  .donut-wrap { flex-direction: column; align-items: center; gap: 1rem; }
  .donut-legend { width: 100%; }
}

/* ── Stats: Bar Chart ──────────────────────────────────────────────────────── */
.bar-list { display: flex; flex-direction: column; gap: .65rem; }
.bar-item { display: flex; align-items: center; gap: .75rem; }
.bar-label {
  font-size: .82rem; width: 90px; flex-shrink: 0;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.bar-track {
  flex: 1; height: 22px; background: var(--bg);
  border-radius: 6px; overflow: hidden; position: relative;
}
.bar-fill {
  height: 100%; border-radius: 6px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  transition: width .6s ease;
  min-width: 2px;
}
.bar-value {
  font-size: .78rem; color: var(--gold); font-weight: 700;
  width: 50px; text-align: right; flex-shrink: 0;
}

/* ── Stats: Wine List ──────────────────────────────────────────────────────── */
.wine-list { display: flex; flex-direction: column; gap: .6rem; }
.wine-list-item {
  display: flex; align-items: center; gap: .75rem;
  padding: .5rem .6rem; background: var(--bg);
  border-radius: 8px; position: relative; overflow: hidden;
}
.wine-list-item .rank {
  font-size: .75rem; font-weight: 800; color: var(--accent);
  width: 20px; text-align: center; flex-shrink: 0;
}
.wine-list-item .rank .mdi { font-size: 1rem; }
.wine-list-item .wine-info { flex: 1; min-width: 0; }
.wine-list-item .wine-name {
  font-size: .85rem; font-weight: 600;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.wine-list-item .wine-detail {
  font-size: .75rem; color: var(--muted);
}
.wine-list-item .stars { color: var(--gold); font-size: .85rem; flex-shrink: 0; }
.wine-list-item .stars .mdi { font-size: .95rem; }
.wine-list-item .wine-price { color: var(--gold); font-size: .85rem; font-weight: 700; flex-shrink: 0; }

/* Type corner ribbon (color stripe in wine lists) */
.type-corner {
  position: absolute; top: 2px; left: -10px;
  width: 40px; height: 9px;
  transform: rotate(-45deg);
  transform-origin: center;
}
.type-corner.type-rotwein     { background: var(--wine-rotwein); }
.type-corner.type-weisswein   { background: var(--wine-weisswein); }
.type-corner.type-rose        { background: var(--wine-rose); }
.type-corner.type-schaumwein  { background: var(--wine-schaumwein); }
.type-corner.type-dessertwein { background: var(--wine-dessertwein); }
.type-corner.type-likoerwein  { background: var(--wine-likoerwein); }
.type-corner.type-anderes     { background: var(--wine-anderes); }

/* ── Stats: Globe Map ──────────────────────────────────────────────────────── */
.map-card {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden;
  margin-bottom: 1.5rem;
}
.globe-wrap {
  position: relative;
  display: flex; justify-content: center; align-items: center;
  padding: 1rem 0;
  background: var(--surface);
}
#globeCanvas {
  width: 100%; max-width: 500px;
  aspect-ratio: 1 / 1;
  cursor: grab;
}
#globeCanvas:active { cursor: grabbing; }
.globe-legend {
  position: absolute; left: .75rem; top: .75rem;
  display: flex; flex-direction: column; gap: .35rem;
  padding: .6rem .8rem; border-radius: 10px;
  background: var(--bg);
  max-height: 80%; overflow-y: auto;
  pointer-events: none;
}
.globe-legend-item {
  display: flex; align-items: center; gap: .45rem;
  font-size: .7rem; color: var(--text); white-space: nowrap;
}
.globe-legend-dot {
  width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0;
  background: var(--accent);
}
.globe-legend-qty {
  margin-left: auto; font-weight: 700; padding-left: .5rem;
  opacity: .8;
}
@media (max-width: 500px) {
  #globeCanvas { max-width: 280px; }
  .globe-legend { display: none; }
}

/* (Stats empty state now reuses .empty-state from Index) */
